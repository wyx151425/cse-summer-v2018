<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="application/json; charset=UTF-8">
    <title>产品管理</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.css}">
    <link rel="stylesheet" th:href="@{/css/summer.css}">
    <script th:src="@{/js/jquery-3.3.1.min.js}"></script>
    <script th:src="@{/js/bootstrap.js}"></script>
    <script th:src="@{/js/machine.js}"></script>
</head>
<body>
<aside class="aside">
    <ul class="list">
        <li class="list-item">
            <span class="glyphicon glyphicon-triangle-right"></span>
            <span th:text="${product.name}"></span>
        </li>
    </ul>
</aside>
<div id="main">
    <header class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                        data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">CSE</a>
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="#" data-toggle="modal" data-target="#importManXml">MAN</a></li>
                    <li><a href="#" data-toggle="modal" data-target="#importWinGDExcel">WinGD</a></li>
                </ul>
            </div>
        </div>
    </header>
    <main class="container">
        <div class="material-detail">
            <div class="table-wrap">
                <button type="button" data-target="#importNewVersionStructure" data-toggle="modal"
                        class="btn btn-primary pull-right"
                        style="margin-bottom: 20px">导入新版本部套
                </button>
                <table id="table" class="table table-bordered table-hover">
                    <thead>
                    <tr>
                        <th class="col-lg-3 col-md-3">部套号</th>
                        <th class="col-lg-3 col-md-3">当前版本</th>
                        <th class="col-lg-3 col-md-3">最新版本</th>
                        <th class="col-lg-3 col-md-3">操作</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr class="structure" th:each="record, recordStat : ${materialList}">
                        <td th:text="${record.structureNo}"></td>
                        <td th:text="${record.version}"></td>
                        <td th:text="${record.latestVersion}"></td>
                        <td>
                            <a th:href="@{|/files/export/structure?machineName=${product.name}&structureNo=${record.structureNo}&version=${record.version}|}">导出该版本</a>
                            <a href="javascript:;"
                               th:onclick="|javascript:useLatestVersion('${product.name}', '${record.structureNo}');|"
                               th:if="${record.version != record.latestVersion}">使用最新版本</a>
                            <a th:href="@{|/files/export/structure?machineName=${product.name}&structureNo=${record.structureNo}&version=${record.latestVersion}|}"
                               th:if="${record.version != record.latestVersion}">导出最新版本</a>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>
</div>
<div class="modal fade" id="importManXml" tabindex="-1" role="dialog" aria-labelledby="ManXmlLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="ManXmlLabel">导入 MAN XML 文件</h4>
            </div>
            <form th:action="@{/files/import/xml}" th:method="POST" enctype="multipart/form-data">
                <div class="modal-body">
                    <label for="productName1" class="control-label col-lg-2 col-md-2">机器</label>
                    <div class="form-group col-lg-10 col-md-10">
                        <input id="productName1" type="text" class="form-control" name="machineName"/>
                    </div>
                    <label for="excelFile" class="control-label col-lg-2 col-md-2">文件</label>
                    <div class="form-group col-lg-10 col-md-10">
                        <input id="xmlFile" class="form-control" name="xmlFile" type="file"/>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                    <button type="submit" class="btn btn-primary">导入</button>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="modal fade" id="importWinGDExcel" tabindex="-1" role="dialog" aria-labelledby="WinGDExcelLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="WinGDExcelLabel">导入 WinGD Excel 文件</h4>
            </div>
            <form th:action="@{/files/import/excel}" th:method="POST" enctype="multipart/form-data">
                <div class="modal-body">
                    <label for="productName2" class="control-label col-lg-2 col-md-2">机器</label>
                    <div class="form-group col-lg-10 col-md-10">
                        <input id="productName2" type="text" class="form-control" name="machineName"/>
                    </div>
                    <label for="excelFile" class="control-label col-lg-2 col-md-2">文件</label>
                    <div class="form-group col-lg-10 col-md-10">
                        <input id="excelFile" class="form-control" name="excelFile" type="file"/>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                    <button type="submit" class="btn btn-primary">导入</button>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="modal fade" id="importNewVersionStructure" tabindex="-1" role="dialog" aria-labelledby="StructureLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="StructureLabel">导入新版本部套</h4>
            </div>
            <form th:action="@{/files/import/newVerStruct}" th:method="POST" enctype="multipart/form-data">
                <div class="modal-body">
                    <label for="productName3" class="control-label col-lg-2 col-md-2">机器名</label>
                    <div class="form-group col-lg-10 col-md-10">
                        <input id="productName3" type="text" class="form-control" name="machineName"
                               th:value="${product.name}" readonly="readonly"/>
                    </div>
                    <label for="structureNo" class="control-label col-lg-2 col-md-2">部套号</label>
                    <div class="form-group col-lg-10 col-md-10">
                        <input id="structureNo" type="text" class="form-control" name="structureNo"/>
                    </div>
                    <label for="structureFile" class="control-label col-lg-2 col-md-2">文件</label>
                    <div class="form-group col-lg-10 col-md-10">
                        <input id="structureFile" class="form-control" name="structureFile" type="file"/>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                    <button type="submit" class="btn btn-primary">导入</button>
                </div>
            </form>
        </div>
    </div>
</div>
</body>
</html>